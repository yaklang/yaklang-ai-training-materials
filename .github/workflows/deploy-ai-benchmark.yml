name: Deploy AI Benchmark

on:
  # å½“æŒ‡å®šæ–‡ä»¶æœ‰æ”¹åŠ¨æ—¶è§¦å‘
  # push:
  #   branches:
  #     - main
  #   paths:
  #     - 'apps/ai-vuln-detection-benchmark/**'
  #     - '.github/workflows/deploy-ai-benchmark.yml'
  
  # å…è®¸æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:

# ç¡®ä¿åŒä¸€æ—¶é—´åªè¿è¡Œä¸€ä¸ªéƒ¨ç½²ä»»åŠ¡
concurrency:
  group: deploy-ai-benchmark
  cancel-in-progress: false

jobs:
  deploy:
    runs-on: ubuntu-22.04
    
    env:
      APP_NAME: ai-benchmark
      APP_PATH: apps/ai-vuln-detection-benchmark
      REPORT_VIEWER_SCRIPT: report-viewer.yak
      REPORT_VIEWER_SERVICE_NAME: yak-ai-benchmark-report-viewer
      AUTO_RUNNER_SERVICE_NAME: ai-benchmark-auto-runner
      AUTO_RUNNER_TIMER_NAME: ai-benchmark-auto-runner.timer
      WORK_DIR: /root/yaklang-ai-training-materials
      YAK_VERSION: 1.4.4-alpha1121a
      YAK_PATH: /usr/local/bin/yak-1.4.4-alpha1121a
      REPORT_VIEWER_PORT: ${{ secrets.AI_BENCHMARK_REPORT_PORT }}
      REPORT_DIR: /root/ai-benchmark-reports-v2
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Print trigger information
        run: |
          echo "============================================"
          echo "éƒ¨ç½²åº”ç”¨: ${{ env.APP_NAME }}"
          echo "Report Viewer æœåŠ¡: ${{ env.REPORT_VIEWER_SERVICE_NAME }}"
          echo "è§¦å‘æ–¹å¼: ${{ github.event_name }}"
          echo "åˆ†æ”¯: ${{ github.ref }}"
          echo "æäº¤: ${{ github.sha }}"
          echo "æ“ä½œè€…: ${{ github.actor }}"
          echo "============================================"
      
      - name: Validate secrets
        run: |
          echo "=== éªŒè¯ Secrets ==="
          
          if [ -z "${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}" ]; then
            echo "ERROR: EMBEDDING_HOST_PRIVATE_KEY secret æœªè®¾ç½®"
            exit 1
          fi
          echo "âœ“ EMBEDDING_HOST_PRIVATE_KEY å·²è®¾ç½®"
          
          if [ -z "${{ secrets.EMBEDDING_HOST }}" ]; then
            echo "ERROR: EMBEDDING_HOST secret æœªè®¾ç½®"
            exit 1
          fi
          echo "âœ“ EMBEDDING_HOST å·²è®¾ç½®"
          
          if [ -z "${{ secrets.AI_BENCHMARK_API_KEY }}" ]; then
            echo "WARNING: AI_BENCHMARK_API_KEY secret æœªè®¾ç½®ï¼Œå°†ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤å€¼"
          else
            echo "âœ“ AI_BENCHMARK_API_KEY å·²è®¾ç½®"
          fi
          
          echo "âœ“ Secrets éªŒè¯å®Œæˆ"
      
      - name: Prepare deployment package
        env:
          AI_BENCHMARK_API_KEY: ${{ secrets.AI_BENCHMARK_API_KEY }}
        run: |
          echo "=== å‡†å¤‡éƒ¨ç½²åŒ… ==="
          
          # éªŒè¯é…ç½®æ–‡ä»¶å­˜åœ¨
          CONFIG_DIR="${{ env.APP_PATH }}/config"
          
          if [ ! -f "$CONFIG_DIR/test-config.json" ]; then
            echo "ERROR: $CONFIG_DIR/test-config.json ä¸å­˜åœ¨"
            exit 1
          fi
          echo "âœ“ test-config.json å­˜åœ¨"
          
          if [ ! -f "$CONFIG_DIR/ai-config.json" ]; then
            echo "ERROR: $CONFIG_DIR/ai-config.json ä¸å­˜åœ¨"
            exit 1
          fi
          echo "âœ“ ai-config.json å­˜åœ¨"
          
          # åˆ›å»ºéƒ¨ç½²ç›®å½•ç»“æž„
          DEPLOY_DIR="deploy-package"
          mkdir -p "$DEPLOY_DIR"/{app-files,configs,scripts,apps}
          
          # 1. å¤åˆ¶åº”ç”¨æ–‡ä»¶ï¼ˆè·³è¿‡ .md æ–‡ä»¶å’Œ config ç›®å½•ï¼‰
          echo "å‡†å¤‡åº”ç”¨æ–‡ä»¶..."
          for file in ${{ env.APP_PATH }}/*; do
            if [ -f "$file" ]; then
              filename=$(basename "$file")
              if [[ "$filename" != *.md ]]; then
                echo "  â†’ $filename"
                cp "$file" "$DEPLOY_DIR/app-files/"
              fi
            fi
          done
          
          # 2. å¤åˆ¶é…ç½®æ–‡ä»¶
          echo "å‡†å¤‡é…ç½®æ–‡ä»¶..."
          cp "$CONFIG_DIR/test-config.json" "$DEPLOY_DIR/configs/"
          cp "$CONFIG_DIR/ai-config.json" "$DEPLOY_DIR/configs/"
          
          # 3. åˆ›å»ºçŽ¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
          echo "åˆ›å»ºçŽ¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶..."
          
          # Benchmark çŽ¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼ˆåŒ…å« API Keyï¼‰
          cat > "$DEPLOY_DIR/configs/benchmark-config.env" << EOF
          # AI Benchmark åº”ç”¨é…ç½®
          REPORT_DIR=${{ env.REPORT_DIR }}
          AI_BENCHMARK_API_KEY=${AI_BENCHMARK_API_KEY}
          EOF
          
          # Report Viewer çŽ¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
          cat > "$DEPLOY_DIR/configs/report-viewer-config.env" << EOF
          # AI Benchmark Report Viewer é…ç½®
          REPORT_VIEWER_PORT=${{ env.REPORT_VIEWER_PORT }}
          REPORT_DIR=${{ env.REPORT_DIR }}
          EOF
          
          # 4. å¤åˆ¶éƒ¨ç½²è„šæœ¬
          echo "å‡†å¤‡éƒ¨ç½²è„šæœ¬..."
          cp ./apps/deploy-yak-app.sh "$DEPLOY_DIR/apps/"
          cp ./scripts/install-yak-scripts-to-systemd.yak "$DEPLOY_DIR/scripts/"
          
          # æ˜¾ç¤ºéƒ¨ç½²åŒ…å†…å®¹
          echo ""
          echo "=== éƒ¨ç½²åŒ…å†…å®¹ ==="
          find "$DEPLOY_DIR" -type f | head -30
          
          echo ""
          echo "âœ“ éƒ¨ç½²åŒ…å‡†å¤‡å®Œæˆ"
      
      - name: Create remote directories
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          script: |
            echo "=== åˆ›å»ºè¿œç¨‹ç›®å½• ==="
            mkdir -p ${{ env.WORK_DIR }}/${{ env.APP_PATH }}
            mkdir -p ${{ env.WORK_DIR }}/apps
            mkdir -p ${{ env.WORK_DIR }}/scripts
            mkdir -p ${{ env.REPORT_DIR }}
            echo "âœ“ ç›®å½•åˆ›å»ºå®Œæˆ"
      
      - name: Upload application files
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          source: "deploy-package/app-files/*"
          target: "${{ env.WORK_DIR }}/${{ env.APP_PATH }}/"
          strip_components: 2
      
      - name: Upload config files
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          source: "deploy-package/configs/*"
          target: "/tmp/ai-benchmark-configs/"
          strip_components: 2
      
      - name: Upload deploy scripts
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          source: "deploy-package/apps/*,deploy-package/scripts/*"
          target: "/tmp/ai-benchmark-deploy/"
          strip_components: 1
      
      - name: Setup files on remote server
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          script: |
            echo "=== è®¾ç½®æ–‡ä»¶ ==="
            
            # ç§»åŠ¨éƒ¨ç½²è„šæœ¬
            echo "ç§»åŠ¨éƒ¨ç½²è„šæœ¬..."
            mv /tmp/ai-benchmark-deploy/apps/deploy-yak-app.sh ${{ env.WORK_DIR }}/apps/deploy-yak-app.sh
            chmod +x ${{ env.WORK_DIR }}/apps/deploy-yak-app.sh
            
            mv /tmp/ai-benchmark-deploy/scripts/install-yak-scripts-to-systemd.yak ${{ env.WORK_DIR }}/scripts/install-yak-scripts-to-systemd.yak
            
            # ç§»åŠ¨é…ç½®æ–‡ä»¶
            echo "ç§»åŠ¨é…ç½®æ–‡ä»¶..."
            mv /tmp/ai-benchmark-configs/test-config.json ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/test-config.json
            mv /tmp/ai-benchmark-configs/ai-config.json ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/ai-config.json
            mv /tmp/ai-benchmark-configs/benchmark-config.env ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/.env.benchmark
            mv /tmp/ai-benchmark-configs/report-viewer-config.env ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/.env.report-viewer
            
            # è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™
            echo "è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™..."
            chmod +x ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/auto-benchmark.sh
            
            # æ¸…ç†ä¸´æ—¶ç›®å½•
            rm -rf /tmp/ai-benchmark-deploy /tmp/ai-benchmark-configs
            
            echo ""
            echo "=== éªŒè¯æ–‡ä»¶ ==="
            ls -lh ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/
            
            echo ""
            echo "âœ“ æ–‡ä»¶è®¾ç½®å®Œæˆ"
      
      - name: Deploy Report Viewer Service
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          script: |
            echo "=== éƒ¨ç½² Report Viewer æœåŠ¡ ==="
            
            echo "æ‰§è¡Œéƒ¨ç½²å‘½ä»¤..."
            ${{ env.WORK_DIR }}/apps/deploy-yak-app.sh \
              --service-name "${{ env.REPORT_VIEWER_SERVICE_NAME }}" \
              --main-script "${{ env.APP_PATH }}/${{ env.REPORT_VIEWER_SCRIPT }}" \
              --work-dir "${{ env.WORK_DIR }}" \
              --yak-version "${{ env.YAK_VERSION }}" \
              --yak-path "${{ env.YAK_PATH }}" \
              --config-file "${{ env.APP_PATH }}/.env.report-viewer" \
              --script-args '--port $REPORT_VIEWER_PORT --report-dir $REPORT_DIR --frontend ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/report-viewer.html' \
              --verify-port "${{ env.REPORT_VIEWER_PORT }}" \
              --install-yak
            
            echo ""
            echo "âœ“ Report Viewer éƒ¨ç½²å®Œæˆ"
      
      - name: Deploy Auto Runner Service
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          script: |
            echo "=== éƒ¨ç½² Auto Runner å®šæ—¶æœåŠ¡ ==="
            
            # 1. å¤åˆ¶ service å’Œ timer æ–‡ä»¶åˆ° systemd ç›®å½•
            echo "Installing systemd service and timer files..."
            cp ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/ai-benchmark-auto-runner.service /etc/systemd/system/
            cp ${{ env.WORK_DIR }}/${{ env.APP_PATH }}/ai-benchmark-auto-runner.timer /etc/systemd/system/
            
            # 2. é‡æ–°åŠ è½½ systemd
            echo "Reloading systemd daemon..."
            systemctl daemon-reload
            
            # 3. åœæ­¢æ—§çš„æœåŠ¡ï¼ˆå¦‚æžœæ­£åœ¨è¿è¡Œï¼‰
            echo "Stopping old services if running..."
            systemctl stop ai-benchmark-auto-runner.timer || true
            systemctl stop ai-benchmark-auto-runner.service || true
            
            # 4. å¯ç”¨å¹¶å¯åŠ¨ timer
            echo "Enabling and starting timer..."
            systemctl enable ai-benchmark-auto-runner.timer
            systemctl start ai-benchmark-auto-runner.timer
            
            # 5. éªŒè¯æœåŠ¡çŠ¶æ€
            echo ""
            echo "Checking timer status..."
            systemctl status ai-benchmark-auto-runner.timer --no-pager || true
            
            echo ""
            echo "Listing active timers..."
            systemctl list-timers ai-benchmark-auto-runner.timer --no-pager || true
            
            echo ""
            echo "âœ“ Auto Runner å®šæ—¶æœåŠ¡éƒ¨ç½²æˆåŠŸ"
      
      - name: Verify deployment
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.EMBEDDING_HOST }}
          username: root
          key: ${{ secrets.EMBEDDING_HOST_PRIVATE_KEY }}
          script: |
            echo "=== éªŒè¯éƒ¨ç½² ==="
            
            # ç­‰å¾…æœåŠ¡å¯åŠ¨
            echo "ç­‰å¾…æœåŠ¡ç¨³å®š..."
            sleep 5
            
            # éªŒè¯ Report Viewer æœåŠ¡
            echo ""
            echo "æ£€æŸ¥ Report Viewer æœåŠ¡çŠ¶æ€..."
            systemctl is-active ${{ env.REPORT_VIEWER_SERVICE_NAME }} && echo "âœ“ Report Viewer æœåŠ¡å·²æ¿€æ´»" || echo "âœ— Report Viewer æœåŠ¡æœªæ¿€æ´»"
            
            echo ""
            echo "Report Viewer æœåŠ¡çŠ¶æ€è¯¦æƒ…..."
            systemctl status ${{ env.REPORT_VIEWER_SERVICE_NAME }} --no-pager -l || true
            
            # å¥åº·æ£€æŸ¥ Report Viewer
            echo ""
            echo "Report Viewer å¥åº·æ£€æŸ¥..."
            curl -f http://127.0.0.1:${{ env.REPORT_VIEWER_PORT }}/ 2>/dev/null && echo "âœ“ Report Viewer å“åº”æ­£å¸¸" || echo "âš  Report Viewer å¥åº·æ£€æŸ¥å¤±è´¥"
            
            # éªŒè¯ Auto Runner Timer
            echo ""
            echo "æ£€æŸ¥ Auto Runner Timer çŠ¶æ€..."
            systemctl is-active ai-benchmark-auto-runner.timer && echo "âœ“ Auto Runner Timer å·²æ¿€æ´»" || echo "âœ— Auto Runner Timer æœªæ¿€æ´»"
            
            echo ""
            echo "Auto Runner Timer çŠ¶æ€è¯¦æƒ…..."
            systemctl status ai-benchmark-auto-runner.timer --no-pager -l || true
            
            echo ""
            echo "ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´..."
            systemctl list-timers ai-benchmark-auto-runner.timer --no-pager || true
            
            # æ£€æŸ¥æŠ¥å‘Šç›®å½•
            echo ""
            echo "æ£€æŸ¥æŠ¥å‘Šç›®å½•..."
            ls -lh ${{ env.REPORT_DIR }} 2>/dev/null && echo "âœ“ æŠ¥å‘Šç›®å½•å­˜åœ¨" || echo "âš  æŠ¥å‘Šç›®å½•ä¸ºç©ºæˆ–ä¸å­˜åœ¨"
            
            echo ""
            echo "âœ“ æœåŠ¡éªŒè¯å®Œæˆ"
      
      - name: Cleanup
        if: always()
        run: |
          echo "=== æ¸…ç† ==="
          rm -rf deploy-package
          echo "âœ“ æ¸…ç†å®Œæˆ"
      
      - name: Summary
        if: success()
        run: |
          echo "## âœ… AI Benchmark éƒ¨ç½²æˆåŠŸ" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "AI æ¼æ´žæ£€æµ‹åŸºå‡†æµ‹è¯•ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸš€ éƒ¨ç½²è¯¦æƒ…" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### Report Viewer æœåŠ¡" >> $GITHUB_STEP_SUMMARY
          echo "- æœåŠ¡åç§°: \`${{ env.REPORT_VIEWER_SERVICE_NAME }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- è„šæœ¬: \`${{ env.APP_PATH }}/${{ env.REPORT_VIEWER_SCRIPT }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- ç«¯å£: \`${{ env.REPORT_VIEWER_PORT }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- è®¿é—®æ–¹å¼: Web ç•Œé¢" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### Auto Runner å®šæ—¶æœåŠ¡" >> $GITHUB_STEP_SUMMARY
          echo "- æœåŠ¡åç§°: \`${{ env.AUTO_RUNNER_SERVICE_NAME }}.service\`" >> $GITHUB_STEP_SUMMARY
          echo "- å®šæ—¶å™¨åç§°: \`${{ env.AUTO_RUNNER_TIMER_NAME }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- è„šæœ¬: \`${{ env.APP_PATH }}/auto-benchmark.sh\`" >> $GITHUB_STEP_SUMMARY
          echo "- è¿è¡Œæ¨¡å¼: å®šæ—¶ä»»åŠ¡ (æ¯ 5 åˆ†é’Ÿ)" >> $GITHUB_STEP_SUMMARY
          echo "- é…ç½®æ¥æº: apps/ai-vuln-detection-benchmark/config/" >> $GITHUB_STEP_SUMMARY
          echo "- API Key: GitHub Secrets (AI_BENCHMARK_API_KEY)" >> $GITHUB_STEP_SUMMARY
          echo "- åŠŸèƒ½: è‡ªåŠ¨æ£€æµ‹æ–°å¼•æ“Žç‰ˆæœ¬å¹¶æ‰§è¡Œæµ‹è¯•" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### å…±äº«é…ç½®" >> $GITHUB_STEP_SUMMARY
          echo "- æŠ¥å‘Šç›®å½•: \`${{ env.REPORT_DIR }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- å·¥ä½œç›®å½•: \`${{ env.WORK_DIR }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- å¼•æ“Žå­˜å‚¨: \`/root/yaklang-ai-training-materials/ai-vuln-detection-benchmark-service/yak-engine\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ“Š æž„å»ºä¿¡æ¯" >> $GITHUB_STEP_SUMMARY
          echo "- æäº¤: \`${{ github.sha }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- åˆ†æ”¯: \`${{ github.ref_name }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- è§¦å‘è€…: @${{ github.actor }}" >> $GITHUB_STEP_SUMMARY
          echo "- YAK ç‰ˆæœ¬: \`${{ env.YAK_VERSION }}\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ”§ æœåŠ¡ç®¡ç†å‘½ä»¤" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### Report Viewer æœåŠ¡" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`bash" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹æœåŠ¡çŠ¶æ€" >> $GITHUB_STEP_SUMMARY
          echo "systemctl status ${{ env.REPORT_VIEWER_SERVICE_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹æœåŠ¡æ—¥å¿—" >> $GITHUB_STEP_SUMMARY
          echo "journalctl -u ${{ env.REPORT_VIEWER_SERVICE_NAME }} -f" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# é‡å¯æœåŠ¡" >> $GITHUB_STEP_SUMMARY
          echo "systemctl restart ${{ env.REPORT_VIEWER_SERVICE_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### Auto Runner å®šæ—¶æœåŠ¡" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`bash" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹å®šæ—¶å™¨çŠ¶æ€" >> $GITHUB_STEP_SUMMARY
          echo "systemctl status ${{ env.AUTO_RUNNER_TIMER_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´" >> $GITHUB_STEP_SUMMARY
          echo "systemctl list-timers ${{ env.AUTO_RUNNER_TIMER_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹æœåŠ¡æ—¥å¿—" >> $GITHUB_STEP_SUMMARY
          echo "journalctl -u ${{ env.AUTO_RUNNER_SERVICE_NAME }} -f" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# æŸ¥çœ‹è„šæœ¬æ—¥å¿—" >> $GITHUB_STEP_SUMMARY
          echo "tail -f /root/yaklang-ai-training-materials/ai-vuln-detection-benchmark-service/auto-benchmark.log" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ‰§è¡Œ" >> $GITHUB_STEP_SUMMARY
          echo "systemctl start ${{ env.AUTO_RUNNER_SERVICE_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# åœæ­¢å®šæ—¶å™¨" >> $GITHUB_STEP_SUMMARY
          echo "systemctl stop ${{ env.AUTO_RUNNER_TIMER_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "# å¯åŠ¨å®šæ—¶å™¨" >> $GITHUB_STEP_SUMMARY
          echo "systemctl start ${{ env.AUTO_RUNNER_TIMER_NAME }}" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ“ æ³¨æ„äº‹é¡¹" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- Auto Runner ä¼šæ¯ 5 åˆ†é’Ÿè‡ªåŠ¨æ£€æŸ¥æœ€æ–°å¼•æ“Žç‰ˆæœ¬" >> $GITHUB_STEP_SUMMARY
          echo "- å‘çŽ°æ–°ç‰ˆæœ¬æ—¶è‡ªåŠ¨ä¸‹è½½å¹¶æ‰§è¡Œæµ‹è¯•" >> $GITHUB_STEP_SUMMARY
          echo "- é…ç½®æ–‡ä»¶ä»Ž config/ ç›®å½•è‡ªåŠ¨éƒ¨ç½²ï¼ŒAPI Key ä»Ž GitHub Secrets è¯»å–" >> $GITHUB_STEP_SUMMARY
          echo "- ä¸¤ä¸ªæœåŠ¡å…±äº«æŠ¥å‘Šç›®å½•: \`${{ env.REPORT_DIR }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- Report Viewer æä¾› Web ç•Œé¢æŸ¥çœ‹æŠ¥å‘Šï¼ˆç«¯å£ \`${{ env.REPORT_VIEWER_PORT }}\`ï¼‰" >> $GITHUB_STEP_SUMMARY
          echo "- æµ‹è¯•ä¼šè‡ªåŠ¨å®‰è£…å¹¶å¯åŠ¨ vulinbox é¶åœº" >> $GITHUB_STEP_SUMMARY
          echo "- æ›´æ–°é…ç½®éœ€ä¿®æ”¹ config/ ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶åŽé‡æ–°éƒ¨ç½²" >> $GITHUB_STEP_SUMMARY
          echo "- æ›´æ–° API Key éœ€ä¿®æ”¹ GitHub Secrets (AI_BENCHMARK_API_KEY) åŽé‡æ–°éƒ¨ç½²" >> $GITHUB_STEP_SUMMARY
          echo "- æŸ¥çœ‹é…ç½®çŠ¶æ€: \`cat /root/yaklang-ai-training-materials/ai-vuln-detection-benchmark-service/config.json\`" >> $GITHUB_STEP_SUMMARY
