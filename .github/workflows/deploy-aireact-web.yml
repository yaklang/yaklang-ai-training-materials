name: Deploy AIReact Web

on:
  # 当指定文件有改动时触发
  push:
    branches:
      - main
    paths:
      - 'apps/aireact-web/**'
      - '.github/workflows/deploy-aireact-web.yml'
      - '.github/workflows/reusable-deploy-yak-app.yml'
  
  # 允许手动触发
  workflow_dispatch:

# 确保同一时间只运行一个部署任务
concurrency:
  group: deploy-aireact-web
  cancel-in-progress: false

jobs:
  deploy:
    uses: ./.github/workflows/reusable-deploy-yak-app.yml
    with:
      app_name: aireact-web
      app_path: apps/aireact-web
      service_name: yak-aireact-web
      install_certs: false
    secrets:
      SSH_HOST: ${{ secrets.AIREACT_WEB_HOST }}
      SSH_PRIVATE_KEY: ${{ secrets.AIREACT_WEB_PRIVATE_KEY }}
      APP_PORT: ${{ secrets.AIREACT_WEB_PORT }}
      APP_CONFIG: ${{ secrets.AIREACT_WEB_CONFIG }}

